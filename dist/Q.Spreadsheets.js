//devin87@qq.com
//build:2016/01/15 11:58:43
!function(){"use strict"}(window),function(e,t){"use strict";function r(e,t,r){return l(t)&&(r=t),r||(r={}),r.width=460,Q.alert('<span class="hot">'+e.toHtml()+"</span>",r)}function i(e){return p("string"==typeof e?e.split(""):e,!0)}function n(e,t,r){var i,n=e.toString(),s=t.toString(),a=n.indexOf("."),o=s.indexOf("."),u=0,h=0;-1!=a&&(u=n.length-a-1),-1!=o&&(h=s.length-o-1),i=Math.pow(10,Math.max(u,h));var c=Math.round(e*i),l=Math.round(t*i);switch(r){case 1:return(c+l)/i;case 2:return(c-l)/i;case 3:return c*l/(i*i);case 4:return c/l}}function s(e,t){var r=e.length,i=r-1;if(0==r||t<e[0])return-2;if(t>e[i])return-1;if(t==e[0])return 0;if(t==e[i])return i;for(var n,s=0,a=i;a>s;)if(n=~~((s+a)/2),e[n]>t)a=n;else{if(e[n+1]==t)return n+1;if(e[n+1]>t)return n;s=n}}function a(e){if(!h){var t=d('<div style="position:absolute;left:-100000px;top:-100000px;"><span></span></div>');h=S(t),Q.body.appendChild(t)}this.el=h,this.reset(e)}function o(e){return c?c.reset(e):c=new a(e)}function u(e){var t=(e.width||120)-50;return e.items.forEach(function(e){var r=c.getWidth(e.text),i=e.group;r>t&&(t=r),i&&i.items&&u(i)}),e.width=t+50,e}var h,c,l=Q.isObject,f=Q.extend,d=(Q.createEle,Q.parseHTML),S=Q.getFirst,p=Q.toMap;a.prototype={css:function(e,r){var i=$(this.el).css(e,r);return r!=t?this:i},setFont:function(e){return e&&this.css("font",e),this},reset:function(e){return this.el.style.cssText="white-space:nowrap;",this.setFont(e)},getResult:function(e,t){var r=this.el;$(r)[t||"text"](e);var i=r.offsetWidth,n=r.offsetHeight;return r.innerHTML="",{width:i,height:n}},getWidth:function(e,t){return this.getResult(e,t).width},getHeight:function(e,t){return this.getResult(e,t).height},destroy:function(){$(this.el).remove(),this.el=h=null}},f(Q,{alertError:r,toSet:i,Num:{add:function(e,t){return n(e,t,1)},sub:function(e,t){return n(e,t,2)},mul:function(e,t){return n(e,t,3)},div:function(e,t){return n(e,t,4)}},findInList:s,getMeasureText:o,processMenuWidth:u,MeasureText:a})}(window),function(){"use strict";function e(e){if(s>e)return i[e];if(o>e)return i[Math.floor(e/s)-1]+i[e%s];if(u>e){var t=Math.floor((e-o)/a),r=Math.floor((e-(t+1)*a-s)/s);return i[t]+i[r]+i[e%s]}}function t(e){e=e.toUpperCase();for(var t=e.length,r=-1,i=0;--t>=0;){var a=n[e.charAt(++r)]+1;i+=a*Math.pow(s,t)}return i-1}var r=Q.toMap,i=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],n=r(i),s=26,a=s*s,o=a+s,u=o*s+s;Q.SS={getColName:e,getColIndex:t}}(window),Q.SS.Events={LOAD:"load",WORKBOOK_READY:"workbook:ready",SHEET_BEFORE:"sheet:before",SHEET_READY:"sheet:ready",SHEET_LOAD:"sheet:load",UI_RESIZE:"ui:resize"},Q.SS.Errors={PARAMETER_ERROR:-2,SHEET_NOT_FOUND:-3,SHEET_ALREADY_EXISTS:-4,SHEET_NAME_NOT_FOUND:-5,SHEET_NAME_ALREADY_EXISTS:-6,SHEET_INDEX_IS_SAME:-7,SHEET_NAME_IS_SAME:-8,SHEET_NUMBER_LESS_TWO:-9},function(e,t){"use strict";function r(e){var t="number"==typeof e?e:parseFloat(e),r=new Date(1899,11,30);return Math.floor(t)==t?r.setDate(30+t):r.setMilliseconds(Math.round(t*y)),r}function i(e){return"number"==typeof e?e:("date"!=g(e)&&(e=Date.from(e)),(e-M)/y)}function n(e){return e.replace(L,"").replace(C,"")}function s(e){return""!=e&&k.test(n(e))}function a(e){return""!=e&&/\//.test(n(e))}function o(e){return""!=e&&$.test(n(e))}function u(e,t){if("string"!=typeof e&&(e=e.toString()),!t)return e;for(var r=[],i=0,n=e.length;n>i;i++){var s=e.charAt(i);r.push(t[s]||s)}return r.join("")}function h(e,t,r){if(r){if(e>19){var i=r[Math.floor(e/10)]+r[10],n=e%10;return 0!=n?i+r[n]:i}return e>10?r[10]+r[e-10]:10==e?r[10]:1==t?r[e]:r[0]+r[e]}var i=e.toString();return 1!=t&&10>e?"0"+i:i}function c(e,t){if("string"!=typeof e&&(e=e.toString()),!t)return e;for(var r=[],i=e.length,n=0,s=!1,a=i-1;a>=0;a-=4){if(n>0){var o=n%3;0==o&&(o=3),r.unshift(t[12+o])}var u=a-4;-1>u&&(u=-1);for(var h=a;h>u;h--){var c=e.charAt(h);if("0"==c){if(h==a){s=!0;continue}if(h-1>u&&"0"==e.charAt(h-1))continue;s||r.unshift(t[0])}else s=!1,a-h>0&&r.unshift(t[9+a-h]),r.unshift(t[c]||c)}n++}return r.join("")}function l(e){e&&E(this,e),this.isDate=!0,this.init()}function f(e){e&&E(this,e),this.init()}function d(e){e&&E(this,e),this.init()}function S(e,t){this.key=e,this.value=parseFloat(t)}function p(e){this.source=e,this.list=[],this.rules=[],this.parse(e)}function v(e){if(!e)return t;var r=J[e];return r?r:r=J[e]=new p(e)}var E=Q.extend,g=Q.type,m=Q.toSet,_=Q.Num,w=(_.add,_.sub),T=_.mul,A=_.div,b=Q.SS,M=new Date(1899,11,30),y=864e5,x=["A/P","AM/PM","上午/下午"],H=x.length,R=x.map(function(e){return[e,e.length,new RegExp("^"+e+"$","i"),e.split("/")]}),N=x.toMap(function(e){return[e.charAt(0),!0]}),k=new RegExp("[ymdhsb]|a{3,}|"+x.join("|")+"|e(?![+-])","i"),O=/^general$/i,D=/^\$([^-]*)-([a-zA-Z0-9]+)$/,F=/^(>|>=|=|<|<=|<>)((-|0|[1-9])\d*(\.\d+)?)$/,I=/[\x00-\xff]/,L=/"\\""/g,C=/"[^"]+"/g,U=/^([0-9\.]+)E([+-])(\d+)$/,W=/^[0]+/,$=/^[^#\.0\?bdeghmnsy%]+$/i,G=m("ymdhsateYMDHSAT"),V=(m("bdeghmnsy[]"),m("#,.0?")),Y=m(["black","red","white","blue","cyan","green","yellow","magenta"]),P={isHide:!0},B=["周","週"],j=[["January","February","March","April","May","June","July","August","September","October","November","December"]],X=[["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["星期日","星期一","星期二","星期三","星期四","星期五","星期六"]],z={1:["○","一","二","三","四","五","六","七","八","九","十","百","千","万","亿","兆"],2:["零","壹","贰","叁","肆","伍","陆","柒","捌","玖","拾","佰","仟","万","亿","兆"],3:["0","1","2","3","4","5","6","7","8","9","十","百","千","万","亿","兆"],4:["○","一","二","三","四","五","六","七","八","九","十","百","千","萬","億","兆"],5:["零","壹","貳","參","肆","伍","陸","柒","捌","玖","拾","佰","仟","萬","億","兆"]},K={LONG_DATE:"yyyy年M月d日",SHORT_DATE:"yyyy/M/d",LONG_TIME:"hh:mm:ss",SHORT_TIME:"h:mm:ss"};l.prototype={init:function(){var e=this,t=e.source;switch(t?O.test(t)&&(e.isGeneral=!0):(t="",e.color||e.isGeneral||e.result||(e.isHide=!0)),this.LCID){case"f800":t=K.LONG_DATE;break;case"f400":t=K.SHORT_TIME}e.source=t,e.isHide||e.isGeneral||this.parse(t)},parse:function(e){for(var r=[],i=[],n={},s=e.length,a=0,o=0,u="",h=!1,c=!1,l=!1,f=0;s>f;f++){var d=e.charAt(f);if('"'!=d||0!=f&&"\\"==e.charAt(f-1)){if(!(a>0))if("["!=d)if("]"!=d){if(!h)if(N[d])for(var S=0;H>S;S++){var p=R[S],v=e.substr(f,p[1]);if(p[2].test(v)){l||(l=!0),r.push({key:p[0],fn:"getHour12Name",args:[p[3]]}),f+=p[1]-1;break}}else if(G[d])if(c=!0,f==s-1||d!=e.charAt(f+1)){f>0&&d==e.charAt(f-1)?u+=d:u=d;var E=u.toLowerCase().charAt(0);"e"!=E?"a"==E&&u.length<3?(r.push(u),u=""):(n[r.length]=i.length,i.push(u),u=""):(r.push({key:"e",fn:"getYear",args:[4]}),u="")}else u+=d;else r.push(d)}else{var g=e.slice(o,f).toLowerCase(),m=g.charAt(0);r.push({key:g,fn:"total",args:[m,c]}),h=!1}else o=f+1,h=!0}else if(a++,1==a)o=f+1;else{if(f>o){var _=e.slice(o,f);r.push('\\"'==_?'"':_)}a=0}}for(var w=!0,T=!1,A=0,b=[],f=0,M=i.length;M>f;f++){var y,x,u=i[f],k=u.length,d=u.charAt(0).toLowerCase();switch("h"==d?(w=!1,T=!0):"s"==d?(T?T=!1:0==A&&(w=!1),A++):"m"==d&&w&&M>f+1&&"s"==i[f+1].charAt(0)&&(w=!1,T=!0),d){case"y":y="getYear",x=[k];break;case"m":k>2?(y="getMonthName",x=[0],3==k?x.push(3):5==k&&x.push(1)):(x=[k],w?y="getMonth":(y="getMinutes",w=!0));break;case"d":3>k?(y="getDate",x=[k]):(y="getWeek",x="804"==this.LCID?3==k?[1,-1,t,B[0]]:[1]:"404"==this.LCID?3==k?[1,-1,t,B[1]]:[1]:3==k?[0,0,3]:[0]);break;case"a":y="getWeek",x="409"==this.LCID?3==k?[0,0,3]:[0]:"404"==this.LCID?3==k?[1,-1,t,B[1]]:[1]:3==k?[1,-1,t,B[0]]:[1];break;case"h":y="getHours",x=[k,l];break;case"s":y="getSeconds",x=[k]}b.push({key:u,fn:y,args:x})}this.source=e;for(var O=[],f=0,s=r.length;s>f;f++)n[f]!=t&&O.push(b[n[f]]),O.push(r[f]);n[r.length]!=t&&O.push(b[n[r.length]]),this.list=O},format:function(e){var t=e;if(isNaN(t)&&(t=i(t)),isNaN(t))return e;var n=t,s=!1;t>0&&61>t&&(60==t?s=!0:t++);{var a=r(t),o=this.specialNum,u=[],h=this.list||[],c=l.util;o?z[o]:null}c.source=o?z[o]:null,c.date=a,c.num=n,c.is_1900_2_29=s;for(var f=0,d=h.length;d>f;f++){var S=h[f];u.push("string"==typeof S?S:c[S.fn].apply(c,S.args))}return u.join("")}},l.util={getYear:function(e){var t=this.date.getFullYear().toString();return u(t.slice(-e),this.source)},getMonth:function(e){return h(this.date.getMonth()+1,e,this.source)},getMonthName:function(e,t){var r=j[e],i=this.date.getMonth(),n=r[i];return t?n.slice(0,t):n},getDate:function(e){var t=this.date.getDate();return this.is_1900_2_29&&t++,h(t,e,this.source)},getWeek:function(e,r,i,n){var s=X[e],a=this.date.getDay(),o=s[a];return r==t&&i==t?o:(n==t&&(n=""),i==t?n+o.slice(r):n+o.slice(r,i))},getHours:function(e,t){var r=this.date.getHours();return t&&(r>12&&(r-=12),0==r&&(r=12)),h(r,e,this.source)},getHour12Name:function(e){return e[this.date.getHours()>12?1:0]},getMinutes:function(e){return h(this.date.getMinutes(),e,this.source)},getSeconds:function(e){return h(this.date.getSeconds(),e,this.source)},total:function(e,t){var i,n=r(this.num);if(t)switch(i=12+24*n.getSeconds(),e){case"m":i*=60;break;case"s":i*=3600}else i=Math.round(Date.total(e,n-M));return c(i,this.source)}},f.prototype={init:function(){var e=this,t=e.source;t?O.test(t)&&(e.isGeneral=!0):(t=e.source="",e.color||e.isGeneral||e.result||(e.isHide=!0)),e.isHide||e.isGeneral||e.parse(t)},parse:function(e){var t=this,r=[],i=0,s=0,o=0,u=0,h=!0;if(t.isFractionFormat=a(e),t.isFractionFormat){var c=n(e).split("/"),l=c[0]||"",f=c[1]||"",d="";t.radix=0,t.denominator="";for(var S=l.length,p=S-1;p>=0;p--){var v=l.charAt(p)||"";" "!=v&&'"'!=v?d=v+d:p=-1}for(var E=0,S=f.length;S>E;E++){var v=f.charAt(E)||" ";0==E&&(d+="/")," "!=v&&'"'!=v&&(t.radix++,isNaN(v)||(t.denominator+=v),d+=v)}e=e.replace(d,"F"),t.fractionFormat=d;for(var g=e.split("F")[0],m=!0,_="",i=0,w=0,S=g.length,T=S-1;T>=0;T--){var v=g.charAt(T)||"";if("#"!=v&&"?"!=v&&"0"!=v||!m)if("?"!=v||m)if('"'!=v)"#"==v||(_=v+_);else if(i++,1==i)w=T+1;else{if(T>w){var A=e.slice(w,T);_=v+_}i=0}else _=" "+_;else{if(T-1>=0&&g.charAt(T-1)==v){("?"==v||"0"==v)&&(_=v+_);continue}_=v+_,m=!1}}e=e.replace(g,_)}for(var T=0,S=e.length;S>T;T++){var v=e.charAt(T);if('"'!=v||0!=T&&"\\"==e.charAt(T-1)){if(!(i>0)&&"*"!=v)if("G"!=v)if(","!=v)if("%"!=v)if("."!=v)if("@"!=v){if(t.isFractionFormat&&"F"==v)r.push(v);else if("E"!=v)V[v]?(t.isScientificNum?o++:t.hasDot?s++:u++,h&&(r.push({isFirstFormat:!0}),h=!1),r.push(v)):r.push({content:v});else if(r.push({content:""}),t.isScientificNum=!0,S>T+1){var b=e.charAt(T+1);("+"==b||"-"==b)&&(r.push(b),T++)}}else r.push(v);else t.hasDot=!0,r.push(v);else t.hasPercent=!0,r.push({content:v});else t.hasComma=!0,r.push(v);else t.hasGeneral=!0,r.push(v)}else if(i++,1==i)w=T+1;else if(2==i){var A=e.slice(w,T);r.push({content:'\\"'==A?'"':A}),i=0}}t.source=e,t.dotLength=s,t.powerLength=o,t.integerLength=u,t.list=r},format:function(e){var r=this,i=r.list||[],n=r.hasComma,s=r.hasDot,a=r.isScientificNum,o=r.dotLength,h=r.powerLength,l=r.integerLength,d=r.specialNum,S=r.isGeneral,p=r.hasGeneral,v=!1,E=f.util;if(isNaN(e))return e;if(r.isFractionFormat&&r.radix>5)return e;0>e&&(v=!0,e=-e),r.isMinus&&(v=!1),r.hasPercent&&(e=T(e,100));var g=e+"";a&&(g=E.parseSicenceNum(e,l,o,h,s));var m=g.split("."),_=m[0]||"",w=m[1]||"";if(o>w.length&&!a&&(w+="0".repeat(o-w.length||0)),d>0&&!a&&("404"==r.LCID&&(d=(parseInt(d)+3).toString()),_=p||S?c(_,z[d]):u(_,z[d]),w.length>0&&(w=u(w,z[d]))),o<w.length&&!a&&!p&&!S){var A=parseInt(w.charAt(o));if(0==o)A>4&&(_=(parseInt(_)+1).toString()),w="";else{var b=w.substring(0,o),M=0,y=0;A>4&&(b=(parseInt(b)+1).toString(),y=b.length,y>o?(_=(parseInt(_)+1).toString(),M=1):b="0".repeat(o-y)+b),w=M>0?b.substring(1):b}}n&&!a&&(_=E.addComma(_));for(var x=0==w.length?_:_+"."+w,H=x.length,R=!1,N=!1,k="",O=i.length,D=O-1;D>=0;D--){var Q=i[D],F="";if("object"==typeof Q)if(Q.isFirstFormat==t)F=Q.content||"";else{if(r.isFractionFormat)continue;F=x.substring(0,H)||""}else if("@"==Q)F=x;else{H--;var I=x.charAt(H);if("."==Q||","==Q)F=I;else if("#"==Q)F=r.isFractionFormat?"0"==x?"":x:H>=0?I:"";else if("0"==Q||"?"==Q)r.isFractionFormat?("0"!=Q||R||(F=l>x.length?"0".repeat(l-x.length)+x:x,R=!0),"?"!=Q||N||(F=l>x.length?" ".repeat(l-x.length)+x:x,N=!0)):F=H>=0?I:Q;else if("E"==Q)F=I;else if("G"==Q&&p)F=x;else if("F"==Q&&r.isFractionFormat)if(""==r.denominator)F=l>1?"  ":" "+E.decimalToFraction(g,1>l,r.radix);else{var L=parseInt(r.denominator),C=E.numToFraction(g,L);F=0==C?"   ":C+"/"+r.denominator}else F=I}k=F+k}return 0==i.length&&(k=x),(v?"-":"")+k}},f.util={addComma:function(e){e+="";var t=e.split("."),r=t[0]||"",i=t[1]||"";if(r.length>3){var n=e.length%3;r=0==n?"":e.substring(0,n);for(var s=0,a=Math.floor(e.length/3);a>s;s++)r+=0==n&&0==s?e.substring(n+3*s,n+3*s+3):","+e.substring(n+3*s,n+3*s+3)}return r+i},isSicenceNum:function(e){return U.test(e)},parseSicenceNum:function(e,t,r,i,n){if(U.test(e))return e;var s=e,a=!1,t=t>3?3:t||1,r=r>=0?r:2,i=i||2;0>s&&(a=!0,s=-s);var o=s.toString(),u=0,h=0,c=0,l="+",f=o.indexOf("."),c=0,d=o.length;if(f>=0)if(1==f){var S=o.charAt(0);if("0"==S){var p=W.exec(o.substring(f+1));h=null!=p?p[0].length+1:1,u=d-f-1,c=u-h,l="-"}else parseInt(S)>0&&(h=u=c=0)}else f>1&&(u=d-f-1,c=d-2,h=c-u);else u=0,h=t>=d?0:d-t;if(c=0==c?h:c,c=t>0&&c>=t?c-t+1:0,s=A(T(s,Math.pow(10,u)),Math.pow(10,c)).toString(),r>0){var v=s.indexOf("."),E=v>0?v:0,g=s.length-E-1;if(g>r){var m=0;g>=r+1&&(m=s.slice(E+1,r+2+E)),s=s.slice(0,E+1)+Math.round(A(parseInt(m),10)).toString()}else g==r?s=s:r>g&&(0==E&&(s+="."),s+="0".repeat(r-g))}else 0==r&&(s=s.slice(0,1));0!=h&&(h="-"==l?h+t-1:h-t+1);var _=h.toString().length;return i>_&&(h="0".repeat(i-_)+h),a&&(s=-s),s+(n&&0==r?".":"")+"E"+l+h},decimalToFraction:function(e,t,r){var i=1,n=0;0>e&&(e=Math.abs(e));var s,a,o=Math.floor(e),u=w(e,o),h=Math.ceil(T(u,Math.pow(10,r)));if(0==u)return"";for(var c=1;h>c;c++)s=Math.round(c/u),a=Math.abs(c/s-u),i>a&&s<Math.pow(10,r)&&(i=a,n=s);return Math.round(n*u)+(t?n*o:0)+"/"+n},numToFraction:function(e,t){0>e&&(e=Math.abs(e));var r=w(e,Math.floor(e));return Math.round(T(r,t))}},d.prototype={init:function(){var e=this,t=e.source;t?O.test(t)&&(e.isGeneral=!0):e.isHide=!0,e.isHide||e.isGeneral||e.parse(t)},parse:function(e){for(var t=this,r=[],i=0,n=0,s=e.length;s>n;n++){var a=e.charAt(n);"_"!=a?"@"!=a?" "!=a||r.push(a):s>n+1&&e.charAt(n+1)==a?i++:(r.push(a),i=0):(r.push('" "'),n++)}t.list=r},format:function(e){var t=this,r=t.list,i=r.length;if(0==i)return e;for(var n="",s=0;i>s;s++)n+="@"==r[s]?e:r[s];return n}},S.prototype={match:function(e){switch(this.key){case">":return e>this.value;case"<":return e<this.value;case"=":return e==this.value;case">=":return e>=this.value;case"<=":return e<=this.value;case"<>":return e!=this.value}return!1}},p.prototype={parse:function(e){var t=this,r=e.length,i=r-2,n=!1;if(i>=0&&";@"==e.slice(i)&&(e=e.slice(0,i)),""==e||O.test(e))return void(t.isGeneral=!0);for(var a=t.list,u=t.rules,h=[],c=0,p=0,v=!0,E=!1,g={},m=0;r>m;m++){var _=e.charAt(m),w=0==c,T="_"==_;if("!"==_||"\\"==_||T){if(w&&v){m>p&&h.push(e.slice(p,m));var A=e.charAt(++m);h.push(T?I.test(A)?'" "':'"  "':'"'==A?'"\\""':'"'+A+'"'),p=m+1}}else if("["==_)w&&(m>p&&h.push(e.slice(p,m)),p=m+1,v=!1);else if('"'==_)v&&(c++,2==c&&(c=0));else if(w)if(v)switch(_){case";":E=!0;break;case"g":case"G":m>p&&h.push(e.slice(p,m)),O.test(e.slice(m,m+7))?(h.push("G"),m+=6,p=m+1):(h.push('"'+_+'"'),p=m+1),n=!0;break;case"]":m>p&&h.push(e.slice(p,m+1)),p=m+1,h.push('"]"')}else if("]"==_){var b=e.slice(p,m).trim();if(""!=b){var M=b.toLowerCase(),y=M.slice(0,5);if(Y[M])g.color=M;else if("color"==y)g.color=b.slice(6);else if("dbnum"==y)g.specialNum=b.slice(5);else if(D.test(b)){var x=RegExp.$1,H=RegExp.$2;x?h.push('"'+x+'"'):H&&(g.LCID=H.toLowerCase())}else{var R=F.exec(b);R?u.push(new S(R[1],R[2])):("h"==M||"m"==M||"s"==M)&&h.push("["+b+"]")}}p=m+1,v=!0}var N=m>=r-1;if(N||E){(N||E)&&h.push(e.slice(p,E?m:r));var k=t._format=h.join("");"G"==k?(g.isGeneral=!0,g.source=""):g.source=k,a.push(s(k)?new l(g):!o(k)||g.isGeneral||n?new f(g):new d(g)),N&&E&&a.push(P),g={},h=[],E&&(E=!1,p=m+1)}}},getFormat:function(e){var t=this.list,r=this.rules,i=t.length,n=r.length;if(!(0>=i)){var s="number"==typeof e;if(!s&&i>0)return t[0];if(n>0){var a=-1;if(s){for(var o=0;n>o;o++)if(r[o].match(e)){a=o;break}return-1==a?i>2?t[2]:i==n?{result:-1}:t[1]:t[a]}return 4==i?t[3]:t[0]}return 1==i?t[0]:s?e>0?t[0]:0>e?(t[1].isMinus=!0,t[1]):t[i>2?2:0]:4==i?t[3]:P}},format:function(e,r){if(this.isHide)return"";var i=this.getFormat(e);if(!i)return e.toString();if(i.isHide)return"";if(i.result!=t)return i.result;var n=i.color,s=i.format(e);switch(r){case 1:return s;case 2:return{text:s,color:n}}return n&&"string"==typeof s?'<span class="cell-format" style="color:'+n+';">'+s+"</span>":s||""},isDate:function(e){var t=this.getFormat(e);return t&&t.isDate}};var J={};E(b,{numberToDate:r,dateToNumber:i,CellFormatter:p,getCellFormatter:v})}(window),function(){"use strict"}(window),function(){"use strict"}(window),function(){"use strict"}(window),function(){"use strict"}(window),function(e,t){"use strict";function r(e){var t=this;t.init(e)}var i=Q.extend,n=Q.clone,s=(Q.toMap,Q.toSet,Q.makeArray),a=Q.factory,o=Q.SS,u=o.Errors,h=Q.SSLang;a(r).extend({init:function(e){return this.parse(e)},reset:function(){return this.parse({})},parse:function(e){e=e||{};var t=this;if(t.index=e.index||0,t.title=e.title||"",t.subject=e.subject||"",t.author=e.author||"",t.company=e.company||"",t.fonts=e.fonts||[],t.styles=e.styles||[],t.formats=e.formats||[],t.ranges=e.ranges||[],t.strings=e.strings||[],t.sheets=e.sheets||[],t.updateSheetMap(),t.numOfDisplaySheets<1)for(var r=0;3>r;r++)t.addSheet();return t},parseSheet:function(e){var t=this;if("number"==typeof e&&(e=t.sheets[e]),e._parsed)return t;e._parsed=!0;for(var r,i,n,s=t.formats,a=t.strings,o=[],u=e.cells||[],h=u.length,c=0,l=0;h>c;c++)r=u[c],i=r[0],n=r[1],o[i]||(o[i]=[]),o[i][r[1]]={type:r[2],value:a[r[3]],format:s[r[4]],style:r[5]},n>l&&(l=n);return e.displayFormula=e.displayFormula!==!1,e.displayGridlines=e.displayGridlines!==!1,e.displayHeadings=e.displayHeadings!==!1,e.colWidths=e.colWidths||{},e.rowHeights=e.rowHeights||{},e.rowStyles=e.rowStyles||{},e.colStyles=e.colStyles||{},e.hiddenRows=e.hiddenRows||[],e.hiddenCols=e.hiddenCols||[],e.merges=e.merges||[],e.links=e.links||[],e.comments=e.comments||[],e.richTexts=e.richTexts||[],e.shapes=e.shapes||[],e.cells=o,e.maxRow=o.length,e.maxCol=l,t},updateSheetMap:function(){var e=this,t=[],r={},i=0;return e.sheets.forEach(function(e,n){e&&(e.index=n,t.push(e),r[e.name]=e,e.isHidden||i++)}),e.sheets=t,e.mapSheet=r,e.numOfDisplaySheets=i,e},_uniqueSheetName:function(e,t,r,i){for(var n,s=0;++s;)if(n=e+r+(t+s)+i,!this.hasSheet(n))return n},createSheetName:function(){return this._uniqueSheetName(h.DEF_SHEET_NAME,0,"","")},cloneSheetName:function(e){return this._uniqueSheetName(e,1," (",")")},isDisplaySheet:function(e){return e&&!e.isHidden},isDisplaySheetAt:function(e){return this.isDisplaySheet(this.sheets[e])},isHiddenSheet:function(e){return e&&e.isHidden},isHiddenSheetAt:function(e){return this.isHiddenSheet(this.sheets[e])},isEmptySheet:function(e){var t=this.sheets[e];if(!t)return!0;var r=t.cells;if(!r||r.length<=0)return!0;if(!t._parsed)return!1;for(var i,n=r.length,s=0;n>s;s++)if(i=r[s],i&&i.length>0)return!1;return!0},hasSheet:function(e){return this.mapSheet[e]!=t},hasHiddenSheet:function(){return this.sheets.some(this.isHiddenSheet)},insertSheet:function(e,r){var i=this,n=i.sheets;return e.index!=t||i.hasSheet(e.name)?u.SHEET_ALREADY_EXISTS:(r==t||-1==r?(e.index=n.length,n.push(e),i.mapSheet[e.name]=e,e.isHidden||i.numOfDisplaySheets++):(n.splice(r,0,e),i.updateSheetMap()),e)},addSheet:function(e){return this.insertSheet(e||{name:this.createSheetName()})},cloneSheet:function(e){var r=this;if("number"==typeof e&&(e=r.sheets[e]),!e)return u.SHEET_NOT_FOUND;var i=n(e);return i.index=t,i.name=r.cloneSheetName(e.name),r.insertSheet(i,e.index)},hideSheet:function(e){var t=this;return"number"==typeof e&&(e=t.sheets[e]),e?t.numOfDisplaySheets<2?u.SHEET_NUMBER_LESS_TWO:(e.isHidden=!0,t.index=t.getNextSheetIndex(e.index),t.numOfDisplaySheets--,t):u.SHEET_NOT_FOUND},cancelHiddenSheets:function(e){var t,r=this,i=r.sheets;return s(e).forEach(function(e){var n=i[+e];n&&(n.isHidden=!1,r.numOfDisplaySheets++,t=n.index)}),t},getSheet:function(e){return this.mapSheet[e]},getSheetAt:function(e){return this.sheets[e!=t?e:this.index]},getNextSheetIndex:function(e,t){for(var r=this,i=r.sheets,n=i.length,s=t?e:e+1;n>s;){if(r.isDisplaySheetAt(s))return s;s++}for(;--e>=0;)if(r.isDisplaySheetAt(e))return e},getNextSheet:function(e,t){var r=this.getNextSheetIndex(e,t);return this.sheets[r]},getHiddenSheets:function(){return this.sheets.filter(this.isHiddenSheet)},setSheet:function(e,t){var r=this;return t.name?r.hasSheet(t.name)?u.SHEET_ALREADY_EXISTS:(r.sheets[e]=t,r.updateSheetMap()):u.SHEET_NAME_NOT_FOUND},renameSheet:function(e,t){var r=this;return"number"==typeof e&&(e=r.sheets[e]),e?t?t==e.name?u.SHEET_NAME_IS_SAME:r.hasSheet(t)?u.SHEET_NAME_ALREADY_EXISTS:(delete r.mapSheet[e.name],e.name=t,r.mapSheet[t]=e,r):u.PARAMETER_ERROR:u.SHEET_NOT_FOUND},moveSheet:function(e,t){var r=this;if(r.numOfDisplaySheets<2)return u.SHEET_NUMBER_LESS_TWO;var i=r.sheets,n=i[e],s=i.length;return n?0>e||e>=s?u.PARAMETER_ERROR:(t>s||-1==t?t=s-1:0>t&&(t=0),t==e?u.SHEET_INDEX_IS_SAME:(i.del(e),t==s-1?i.push(n):i.splice(t,0,n),r.updateSheetMap(),n)):u.SHEET_NOT_FOUND},removeSheet:function(e){var r=this;if(r.numOfDisplaySheets<2)return u.SHEET_NUMBER_LESS_TWO;var i=r.sheets,n=i.length-1;if(-1==e&&(e=n),e==t||0>e||e>n)return u.PARAMETER_ERROR;var s=i[e];return s?(i.del(e),e!=n?r.updateSheetMap():(delete s.index,delete r.mapSheet[s.name],r.numOfDisplaySheets--),s):u.SHEET_NOT_FOUND},getCellFont:function(e){return this.fonts[e]},getCellStyle:function(e){return this.styles[e]},getCellRange:function(e){return this.ranges[e]},getData:function(){var e=this,r={},n=[],s=[],a={},o={},u=[];return["index","title","subject","author","company","fonts","styles","ranges"].forEach(function(t){r[t]=e[t]}),e.sheets.forEach(function(e){var r=i({},e);if(delete r.index,!r._parsed)return void u.push(r);var h=[];r.cells.forEach(function(e,r){e&&e.forEach(function(e,i){if(e){var u=e.format,c=e.value+"",l=u?a[u]:0,f=c?o[c]:0;l==t&&(l=a[u]=n.length,n.push(u)),f==t&&(f=o[c]=s.length,s.push(c)),h.push([r,i,e.type,f,l,e.style])}})}),r.cells=h,u.push(r)}),r.formats=n,r.strings=s,r.sheets=u,r}}),o.Workbook=r}(window),function(e,t){"use strict";function r(e){var t=this;t.api=e,t.ops=e.ops,t.workbook=e.workbook,t.init()}{var i=Array.prototype.slice,n=Q.isFunc,s=Q.extend,a=(Q.toMap,Q.alertError,Q.factory),o=Q.view,u=(Q.Listener,Q.ColorPicker),h=Q.SS,c=(h.Errors,h.Events);h.Workbook,Q.SSLang}a(r).extend({init:function(){var t=this,i=t.ops,n=i.height||"auto",s=i.view;i.height=n,t.elView=s;var a='<div class="ss-toolbar"></div><div class="ss-formulabar"></div><div class="ss-sheet"></div><div class="ss-footbar"></div>';$(s).addClass("ss-view").height("auto"==n?o.getHeight():n).html(a),r.init&&r.init(t),$(e).on("resize",function(){t.updateSize()})},trigger:function(e,t){return this.api.trigger(e,t),this},updateSize:function(){var e=this;return"auto"==e.ops.height&&$(e.elView).height(o.getHeight()),e.run("resizeGrid"),e.trigger(c.UI_RESIZE)},run:function(e){var t=this,r=t[e];return n(r)&&r.apply(t,i.call(arguments,1)),t},runApi:function(e){var t=this,r=t.api||{},s=r[e];return n(s)&&s.apply(r,i.call(arguments,1)),t},loadSheet:function(e){var t=this;return t.sheet=e,t.run("activeTab",e).run("drawSheet",e)},draw:function(e){{var r=this,i=r.workbook,n=(i.fonts,i.styles);e.colWidths,e.rowHeights,e.rowStyles,e.colStyles,e.hiddenRows,e.hiddenCols,e.merges,e.links,e.comments,e.richTexts,e.cells,e.colWidth||80,e.rowHeight||20,e.style!=t?n[e.style]:t}},addSheet:function(){return this.run("drawTabs")},cloneSheet:function(){return this.run("drawTabs")},hideSheet:function(){return this.run("drawTabs")},cancelHiddenSheets:function(){return this.run("drawTabs")},moveSheet:function(){return this.run("drawTabs")},removeSheet:function(){return this.run("drawTabs")},renameSheet:function(e,t){return this.run("renameTab",e,t)}}),s(r,{modules:[],init:function(e){r.scope=e,r.loaded=!0,r.modules.forEach(r.fire)},fire:function(e){n(e)?e(r.scope):"string"==typeof e&&r.scope[e]()},register:function(e){r.modules.push(e),r.loaded&&r.fire(e)},picker:new u({isHex:!0})}),h.UI=r}(window),function(){"use strict";{var e=(Q.extend,Q.vals,Q.toMap,Q.createEle,Q.getMeasureText(),Q.view,Q.ContextMenu,Q.SS),t=(e.ERROR,e.UI);t.picker}t.extend({initToolbar:function(){}}),t.register("initToolbar")}(window),function(){"use strict";{var e=(Q.extend,Q.vals,Q.toMap,Q.createEle,Q.getMeasureText(),Q.view,Q.ContextMenu,Q.SS),t=(e.ERROR,e.Lang,e.UI);t.picker}t.extend({initFormulabar:function(){}}),t.register("initFormulabar")}(window),function(){"use strict"}(window),function(){"use strict"}(window),function(){"use strict"}(window),function(e,t){"use strict";var r=(Q.extend,Q.vals),i=(Q.toMap,Q.createEle,Q.getMeasureText()),n=(Q.view,Q.ContextMenu),s=Q.SS,a=(s.ERROR,s.UI),o=Q.SSLang,u=a.picker,h=1,c=2,l=3,f=4,d=5,S=6,p=7,v=8,E=9,g=10,m=Q.processMenuWidth({width:140,items:[{id:h,text:o.INSERT},{id:c,text:o.REMOVE},{id:l,text:o.RENAME},{split:!0},{id:f,text:o.CLONE},{text:o.MOVE,group:{items:[{id:d,text:o.MOVE_TO_LEFT},{id:S,text:o.MOVE_TO_RIGHT},{id:p,text:o.MOVE_TO_TOP},{id:v,text:o.MOVE_TO_BOTTOM}]}},{text:o.TAB_COLOR,group:u},{split:!0},{id:E,text:o.HIDDEN},{id:g,text:o.CANCEL_HIDDEN}]});a.extend({initFootbar:function(){var e=this,t=e.workbook,r='<table class="sst-table"><tr><td class="sst-w1"><div class="sst-arrow-up sst-view-all" title="'+o.VIEW_ALL_SHEETS+'"></div></td><td class="sst-w2"><div class="sst-tabs"></div></td><td class="sst-w3"><div class="sst-resize"></div></td><td class="sst-w4"><div class="ss-hscroll"><div class="ss-total-width"></div></div></td><td class="sst-w5"></td></tr></table>',i=$(".ss-footbar",e.elView).html(r)[0],s=$(".sst-tabs",i)[0],a=($(".sst-resize",i)[0],$(".ss-hscroll",i)[0]);e.elFootbar=i,e.elTabs=s,e.elHScroll=a,e.drawTabs(),$(".sst-view-all",i).click(function(){var t=e.menuViewAll||e.createMenuViewAll();return t.set({rangeX:0,rangeY:i.offsetTop}).toggle(this.offsetLeft+2,i.offsetTop),!1});var _;$(s).on("click",".sst-item",function(){e.runApi("loadSheetAt",this.x)}).on("contextmenu",".sst-item",function(r){var s=this,a=$(".sst-name",s)[0],o=e.menuTab;return _=s.x,o||(e.menuTab=o=new n(m),o.onclick=function(t,r){switch(r.data.id){case h:e.runApi("addSheet");break;case c:e.runApi("removeSheet",_);break;case l:e.runApi("renameSheet",_);break;case f:e.runApi("cloneSheet",_);break;case d:e.runApi("moveSheet",_,_-1);break;case S:e.runApi("moveSheet",_,_+1);break;case p:e.runApi("moveSheet",_,0);break;case v:e.runApi("moveSheet",_,-1);break;case E:e.runApi("hideSheet",_);break;case g:e.showHiddenSheets()}}),o[t.hasHiddenSheet()?"enableItems":"disableItems"](g),o.set({rangeX:0,rangeY:i.offsetTop+5}).show(r.x,r.y),u.set({color:a.style.color,callback:function(e){var r=t.getSheetAt(s.x);a.style.color=r.tabColor=e,o.hide()}}),e.runApi("loadSheetAt",s.x),!1}).on("click",".sst-insert",function(){e.runApi("addSheet")})},createMenuViewAll:function(){var e=this,t=e.workbook,r=[],s=70,a=e.menuViewAll;a&&a.destroy(),t.sheets.forEach(function(e){if(t.isDisplaySheet(e)){var n=e.index,a=e.name,o=i.getWidth(a);o>s&&(s=o),r.push({id:n,text:a,x:n})}}),e.menuViewAll=a=new n({width:50+s,className:"checked-panel",items:r},{fixedWidth:!0}),a.onclick=function(){e.runApi("loadSheetAt",this.x)};var o=a.getItem(t.index);return o&&$(o.node).addClass("ss-active"),a},drawTabs:function(){var e=this,r=e.workbook,i=r.sheets,n=r.index,s=e.elTabs,a=i.map(function(e){if(!r.isDisplaySheet(e))return"";var t=e.index,i=e.name,s=e.tabColor,a='<div class="sst-item'+(t==n?" sst-on":"")+'" title="'+i+'"'+(s?' style="color:'+s+';"':"")+'><div class="sst-name">'+i+"</div></div>";return a}).join("")+'<div class="sst-insert" title="'+o.INSERT_SHEET+'"><div class="sst-name">+</div></div>';$(s).html(a);var u={};$(".sst-item",s).each(function(e,t){var i=r.getSheet(t.title);t.x=i.index,u[t.x]=t}),e.mapTab=u;var h=e.menuViewAll;h&&(h.destroy(),e.menuViewAll=t)},activeTab:function(e){var t=this,r=t.workbook,i=t.mapTab,n=t.menuViewAll;if($(i[r.index]).removeClass("sst-on"),$(i[e.index]).addClass("sst-on"),n){var s=n.getItem(r.index),a=n.getItem(e.index);s&&$(s.node).removeClass("ss-active"),a&&$(a.node).addClass("ss-active")}},renameTab:function(e,t){var r=this,i=(r.workbook,r.mapTab[e.index]);return $(".sst-name",i).html(t),r.createMenuViewAll(),r},showHiddenSheets:function(){var e=this,t=e.workbook,i='<div class="text">'+o.CANCEL_HIDDEN_SHEETS+'</div><select class="sel-hidden-sheets" multiple="multiple">'+t.sheets.map(function(e){return t.isHiddenSheet(e)?'<option value="'+e.index+'">'+e.name+"</option>":""}).join("")+"</select>",n=new Q.WinBox({title:o.CANCEL_HIDDEN,html:i+Q.bottom(2),width:360,close:"remove",mask:!0});n.on(".x-submit","click",function(){var t=n.get(".sel-hidden-sheets"),i=r(t.selectedOptions,"value");i.length>0&&e.runApi("cancelHiddenSheets",i),n.remove()}).on(".x-cancel","click","remove")}}),a.register("initFootbar")}(window),function(e,t){"use strict";function r(e){var t=this;t._listener=new n(Object.values(o),t),t.ops=e,t.workbook=new u,t.ui=new h(t),t.init()}var i=(Q.async,Q.factory),n=Q.Listener,s=Q.SS,a=s.Errors,o=s.Events,u=s.Workbook,h=s.UI,c=Q.SSLang;i(r).extend({init:function(){var e=this,t=e.ops;e.load(t.data)},on:function(e,t){return this._listener.add(e,t),this},off:function(e,t){return this._listener.remove(e,t),this},trigger:function(e,t){return this._listener.trigger(e,t),this},load:function(e){var t=this,r=t.workbook;return r.parse(e),t.trigger(o.WORKBOOK_READY,r),t.loadSheetAt(r.index)},loadSheet:function(e){var t=this,r=t.workbook;return r.parseSheet(e),t.trigger(o.SHEET_READY,e),t.ui.loadSheet(e),r.index=e.index,t.sheet=e,t.trigger(o.SHEET_LOAD,e)},loadSheetAt:function(e){var t=this,r=t.workbook;e=+e||0;var i=r.getSheetAt(e);return r.isDisplaySheet(i)||(i=r.getNextSheet(e)),t.loadSheet(i)},addSheet:function(){var e=this,t=e.workbook.addSheet();return e.ui.addSheet(t),e},cloneSheet:function(e){var t=this,r=t.workbook.cloneSheet(e);return t.ui.cloneSheet(r),t},hideSheet:function(e){var t,r=this,i=r.workbook,n=i.getSheetAt(e),s=c.HIDDEN_SHEET+" - "+n.name,o=i.hideSheet(e);if("number"==typeof o){switch(o){case a.SHEET_NUMBER_LESS_TWO:t=c.SHEET_NUMBER_LESS_TWO;break;case a.PARAMETER_ERROR:t=c.PARAMETER_ERROR;break;case a.SHEET_NOT_FOUND:t=c.HIDDEN_SHEET_NOT_FOUND}return alertError(t,{title:s})}return r.ui.cloneSheet(n),r},cancelHiddenSheets:function(e){var r=this,i=r.workbook.cancelHiddenSheets(e);return i!=t&&r.ui.cancelHiddenSheets(i),r},moveSheet:function(e,t){var r=this,i=r.workbook,n=i.moveSheet(e,t);return"number"!=typeof n&&r.ui.moveSheet(n),r},removeSheet:function(e){var t=this,r=t.workbook,i=r.getSheetAt(e),n=c.REMOVE_SHEET+" - "+i.name,s=function(i){if(i){var s,o=r.removeSheet(e);if("number"==typeof o){switch(o){case a.SHEET_NUMBER_LESS_TWO:s=c.SHEET_NUMBER_LESS_TWO;break;case a.PARAMETER_ERROR:s=c.PARAMETER_ERROR;break;case a.SHEET_NOT_FOUND:s=c.REMOVE_SHEET_NOT_FOUND}return alertError(s,{title:n})}t.ui.removeSheet(o)}};return r.isEmptySheet(e)?s(!0):(Q.confirm(c.REMOVE_SHEET_CONFIRM,s,{title:n}),t)},renameSheet:function(e){var t=this,r=t.workbook,i=r.getSheetAt(e),n=c.RENAME_SHEET+" - "+i.name;return Q.prompt(c.INPUT_SHEET_NAME,function(e){if(!e)return!1;var s=r.renameSheet(i,e);if("number"==typeof s){switch(s){case a.SHEET_NAME_IS_SAME:errMsg=c.SHEET_NAME_IS_SAME;break;case a.SHEET_NAME_ALREADY_EXISTS:errMsg=c.SHEET_NAME_ALREADY_EXISTS;break;case a.PARAMETER_ERROR:errMsg=c.PARAMETER_ERROR;break;case a.SHEET_NOT_FOUND:errMsg=c.RENAME_SHEET_NOT_FOUND}return alertError(errMsg,{title:n})}t.ui.renameSheet(i,e)},{title:n}),t}}),Q.Spreadsheets=r}(window);